<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>浅行博客重置密码</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="keywords" content="" />
		<script type="application/x-javascript">
			addEventListener("load", function() {
				setTimeout(hideURLbar, 0);
			}, false);

			function hideURLbar() {
				window.scrollTo(0, 1);
			}
		</script>
		<!-- //custom-theme -->
		<link href="../static/css/bootstrap.min.css" rel="stylesheet" type="text/css" media="all" />
		<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
		<link rel="stylesheet" href="css/flexslider.css" type="text/css" media="screen" property="" />
		<!-- js -->
		<script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
		<script type="text/javascript" src="js/jquery.wmuSlider.js"></script><!-- //js -->
		<!-- font-awesome-icons -->
		<link href="../admin/vendor/font-awesome/css/font-awesome.css" rel="stylesheet">
		<!-- //font-awesome-icons -->
		<link href="css/stylelht.css" rel="stylesheet" type="text/css" media="all" />
		<script type="text/javascript" src="js/toastr.min.js"></script>
		<link href="css/toastr.min.css" rel="stylesheet" type="text/css" media="all" />
		<link href="http://fonts.googleapis.com/css?family=Shadows+Into+Light+Two&amp;subset=latin-ext" rel="stylesheet">
		<link href="http://fonts.googleapis.com/css?family=Cinzel" rel="stylesheet">
	</head>
	<body>
	<div class="banner1">
			<div class="container navdiv">	
				<nav class="navbar navbar-default">
					<div class="navbar-header navbar-left">
						<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<h1><a class="navbar-brand" href="index.html">WORK <span>BLOG </span></a></h1>
					</div>
					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse navbar-collapse navbar-right" id="bs-example-navbar-collapse-1">
						<nav>
								<ul class="nav navbar-nav link-effect-14" id="link-effect-14">
									<li ><a href="services.html"><span>首页</span></a></li>
								<li><a href="gallery.html"><span>分类</span></a></li>
								<li><a href="friend.html"><span>友链</span></a></li>
								<li><a href="about.html"><span>关于</span></a>
								</ul>
						<div class="tishi fr">
							<span>返回<a href="login.html" class="ts">登录,</a></span>
							<span>重新<a href="register.html" class="ts">注册</a></span>
						</div>	
							</div>
						</nav>	
					</div>
				</nav>
			</div>
		</div>
	<!-- login <-->
		<!-- 账户名 密码  确认密码 邮箱 验证码 点击发送验证码 注册 -->
					<div class="zczuida">
						<div class="register-box">
						<div class="register-top">重置密码</div>
							<div class="register-neirong">
									<div class="register-z">
										<div class="youxiang-neirong fr">
										  <div class="youxiang-box">
												<div class="youxiang fl">
													<dl>
														<dt>邮&nbsp;&nbsp;&nbsp;箱：</dt>
														<dd>
															<input type="text" class="text email_reset" autocomplete="off" name="email_name" tipmsg="输入验证的邮箱" placeholder="输入验证的邮箱"
															 style="float:right;">
														</dd>
													</dl>
												</div>
												<div class="youxiang-btn fr">
													<input type="submit" class="submit" value="点击发送验证码">
												</div> 
												<div class="reset-form fl">
													<dl>
														<dt>输&nbsp;入&nbsp;验&nbsp;证&nbsp;码：</dt>
														<dd>
															<input type="text" class="text code-reset" autocomplete="off" name="code_name" tipmsg="输入邮箱中收到的验证码" placeholder="输入邮箱中收到的验证码"
															 style="float:right;">
														</dd>
													</dl>
												</div>
												<div class="reset-form fl">
													<dl>
														<dt>新&nbsp;密&nbsp;码：</dt>
														<dd>
															<input type="password" class="text password1" name="password1" autocomplete="off" tipMsg="6-20个大小写英文字母或数字" placeholder="6-20个大小写英文字母或数字"
															 style="float:right;">
														</dd>
													</dl>
												</div>
												<div class="reset-form fl">
													<dl>
														<dt>确&nbsp;认&nbsp;新&nbsp;密&nbsp;码：</dt>
														<dd>
															<input type="password" class="text password2" name="password2" autocomplete="off" tipMsg="6-20个大小写英文字母或数字" placeholder="6-20个大小写英文字母或数字"
															 style="float:right;">
														</dd>
													</dl>
												</div>
												<div class="reset-anniu fl">
															<input type="submit" class="submit1 confirm" value="确认">
												</div>
												
											</div>
											</div>
								    
									</div>
									
							</div>
						</div>
		</div>
		
		<!-- //login -->		
<script type="text/javascript">
		var reg = /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
		var reg1 = /^[a-zA-Z0-9]{6,16}$/;
		$(".email_reset").blur(function(){
			var email_name = $("input[name='email_name']").val();
			if (!reg.test(email_name)) {
				toastr.error("邮箱格式不正确");
				return;
				}
		});
		$(".submit").click(function() {
		var email_name = $("input[name='email_name']").val();
		if (!reg.test(email_name)) {
			    toastr.error("邮箱格式不正确");
					return;
			}else{
				$.ajax({
					method: "get",
					url: "/workblog/user/getemailcode",
					data: {
						"email": email_name
					},
					success: function(result) {
						if(result.state===1){
							toastr.error("请注意查收验证码");
							return;
						}
					},
					error: function(result) {
				      toastr.error("哦吼，出错了~");
					}
				});
			}
		});
			$(".password1").blur(function(){
			var password1 = $("input[name='password1']").val();
			var isPasswordFormat=reg1.test(password1) ;
			if (!isPasswordFormat) {
				toastr.error("密码格式不正确");
				return;
			}		
		});
		$(".password2").blur(function(){
			var password2 = $("input[name='password2']").val();
			var password1 = $("input[name='password1']").val();
			var isPasswordFormat=reg1.test(password1) ;
			var isPasswordFormat1=reg1.test(password2) ;
			if (password1!=password2) {
				toastr.error("两次密码不一致");
				return;
			}		
		});
		$(".confirm").click(function(){
			var email_name = $("input[name='email_name']").val();
			var password1 = $("input[name='password1']").val();
			var password2 = $("input[name='password2']").val();
			var code_name = $("input[name='code_name']").val();
			var isPasswordFormat1=reg1.test(password2) ;
			var isPasswordFormat=reg1.test(password1) ;
				if (!reg.test(email_name)) {
					toastr.error("邮箱格式不正确");
					return;
				}
				if(code_name == null || code_name== ""){
					toastr.error("	验证码不能为空！");
					return;
					}
				if (!isPasswordFormat) {
				toastr.error("密码格式不正确");
				return;
				}
			if (password1!=password2) {
				toastr.error("两次密码不一致");
				return;
			}		
			
				$.ajax({
					method:"post",
					url:"/workblog/user/resetPassword",
					data:{
						"password":password1,
						"code":code_name
					},
					success:function(result){
						if(result.state===1){
						window.location.href="login.html";
						}else{
							toastr.erro("哦吼，出错了~");
						}
					},
				});
		});
</script>
	</body>
</html>
